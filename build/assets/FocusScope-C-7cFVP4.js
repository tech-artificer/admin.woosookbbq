import{i as U}from"./Presence-Bx5YoEz3.js";import{b as j,d as H}from"./index-BnkX3gY3.js";import{j as q,k as $,i as P,l as T,m as Y}from"./index-BiVhXwjY.js";import{q as I,r as w,h as x,s as W,l as V,d as X,f as G,i as L,y as z,o as J,w as Q,m as Z,u as ee}from"./app-cAtTxNmn.js";import{g as E}from"./getActiveElement-FUKBWQwh.js";import{u as te}from"./useForwardExpose-CIuDtJXm.js";import{P as ne}from"./Primitive-D3UVglao.js";function O(e){if(e===null||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t!==null&&t!==Object.prototype&&Object.getPrototypeOf(t)!==null||Symbol.iterator in e?!1:Symbol.toStringTag in e?Object.prototype.toString.call(e)==="[object Module]":!0}function C(e,t,n=".",r){if(!O(t))return C(e,{},n,r);const a=Object.assign({},t);for(const i in e){if(i==="__proto__"||i==="constructor")continue;const c=e[i];c!=null&&(r&&r(a,i,c,n)||(Array.isArray(c)&&Array.isArray(a[i])?a[i]=[...c,...a[i]]:O(c)&&O(a[i])?a[i]=C(c,a[i],(n?`${n}.`:"")+i.toString(),r):a[i]=c))}return a}function re(e){return(...t)=>t.reduce((n,r)=>C(n,r,"",e),{})}const oe=re(),se=q(()=>{const e=w(new Map),t=w(),n=I(()=>{for(const c of e.value.values())if(c)return!0;return!1}),r=U({scrollBody:w(!0)});let a=null;const i=()=>{document.body.style.paddingRight="",document.body.style.marginRight="",document.body.style.pointerEvents="",document.documentElement.style.removeProperty("--scrollbar-width"),document.body.style.overflow=t.value??"",T&&(a==null||a()),t.value=void 0};return x(n,(c,m)=>{var o;if(!P)return;if(!c){m&&i();return}t.value===void 0&&(t.value=document.body.style.overflow);const d=window.innerWidth-document.documentElement.clientWidth,b={padding:d,margin:0},u=(o=r.scrollBody)!=null&&o.value?typeof r.scrollBody.value=="object"?oe({padding:r.scrollBody.value.padding===!0?d:r.scrollBody.value.padding,margin:r.scrollBody.value.margin===!0?d:r.scrollBody.value.margin},b):b:{padding:0,margin:0};d>0&&(document.body.style.paddingRight=typeof u.padding=="number"?`${u.padding}px`:String(u.padding),document.body.style.marginRight=typeof u.margin=="number"?`${u.margin}px`:String(u.margin),document.documentElement.style.setProperty("--scrollbar-width",`${d}px`),document.body.style.overflow="hidden"),T&&(a=j(document,"touchmove",s=>ue(s),{passive:!1})),W(()=>{document.body.style.pointerEvents="none",document.body.style.overflow="hidden"})},{immediate:!0,flush:"sync"}),e});function _e(e){const t=Math.random().toString(36).substring(2,7),n=se();n.value.set(t,e??!1);const r=I({get:()=>n.value.get(t)??!1,set:a=>n.value.set(t,a)});return $(()=>{n.value.delete(t)}),r}function D(e){const t=window.getComputedStyle(e);if(t.overflowX==="scroll"||t.overflowY==="scroll"||t.overflowX==="auto"&&e.clientWidth<e.scrollWidth||t.overflowY==="auto"&&e.clientHeight<e.scrollHeight)return!0;{const n=e.parentNode;return!(n instanceof Element)||n.tagName==="BODY"?!1:D(n)}}function ue(e){const t=e||window.event,n=t.target;return n instanceof Element&&D(n)?!1:t.touches.length>1?!0:(t.preventDefault&&t.cancelable&&t.preventDefault(),!1)}var ae=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},g=new WeakMap,S=new WeakMap,F={},A=0,K=function(e){return e&&(e.host||K(e.parentNode))},ie=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=K(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},ce=function(e,t,n,r){var a=ie(t,Array.isArray(e)?e:[e]);F[n]||(F[n]=new WeakMap);var i=F[n],c=[],m=new Set,d=new Set(a),b=function(o){!o||m.has(o)||(m.add(o),b(o.parentNode))};a.forEach(b);var u=function(o){!o||d.has(o)||Array.prototype.forEach.call(o.children,function(s){if(m.has(s))u(s);else try{var p=s.getAttribute(r),l=p!==null&&p!=="false",f=(g.get(s)||0)+1,v=(i.get(s)||0)+1;g.set(s,f),i.set(s,v),c.push(s),f===1&&l&&S.set(s,!0),v===1&&s.setAttribute(n,"true"),l||s.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",s,y)}})};return u(t),m.clear(),A++,function(){c.forEach(function(o){var s=g.get(o)-1,p=i.get(o)-1;g.set(o,s),i.set(o,p),s||(S.has(o)||o.removeAttribute(r),S.delete(o)),p||o.removeAttribute(n)}),A--,A||(g=new WeakMap,g=new WeakMap,S=new WeakMap,F={})}},le=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),a=ae(e);return a?(r.push.apply(r,Array.from(a.querySelectorAll("[aria-live], script"))),ce(r,a,n,"aria-hidden")):function(){return null}};function ke(e){let t;x(()=>H(e),n=>{n?t=le(n):t&&t()}),V(()=>{t&&t()})}const fe=Y(()=>w([]));function de(){const e=fe();return{add(t){const n=e.value[0];t!==n&&(n==null||n.pause()),e.value=N(e.value,t),e.value.unshift(t)},remove(t){var n;e.value=N(e.value,t),(n=e.value[0])==null||n.resume()}}}function N(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function pe(e){return e.filter(t=>t.tagName!=="A")}const _="focusScope.autoFocusOnMount",k="focusScope.autoFocusOnUnmount",B={bubbles:!1,cancelable:!0};function ve(e,{select:t=!1}={}){const n=E();for(const r of e)if(h(r,{select:t}),E()!==n)return!0}function me(e){const t=R(e),n=M(t,e),r=M(t.reverse(),e);return[n,r]}function R(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const a=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||a?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function M(e,t){for(const n of e)if(!ye(n,{upTo:t}))return n}function ye(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function he(e){return e instanceof HTMLInputElement&&"select"in e}function h(e,{select:t=!1}={}){if(e&&e.focus){const n=E();e.focus({preventScroll:!0}),e!==n&&he(e)&&t&&e.select()}}var be=X({__name:"FocusScope",props:{loop:{type:Boolean,required:!1,default:!1},trapped:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["mountAutoFocus","unmountAutoFocus"],setup(e,{emit:t}){const n=e,r=t,{currentRef:a,currentElement:i}=te(),c=w(null),m=de(),d=G({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});L(u=>{if(!P)return;const o=i.value;if(!n.trapped)return;function s(v){if(d.paused||!o)return;const y=v.target;o.contains(y)?c.value=y:h(c.value,{select:!0})}function p(v){if(d.paused||!o)return;const y=v.relatedTarget;y!==null&&(o.contains(y)||h(c.value,{select:!0}))}function l(v){o.contains(c.value)||h(o)}document.addEventListener("focusin",s),document.addEventListener("focusout",p);const f=new MutationObserver(l);o&&f.observe(o,{childList:!0,subtree:!0}),u(()=>{document.removeEventListener("focusin",s),document.removeEventListener("focusout",p),f.disconnect()})}),L(async u=>{const o=i.value;if(await W(),!o)return;m.add(d);const s=E();if(!o.contains(s)){const l=new CustomEvent(_,B);o.addEventListener(_,f=>r("mountAutoFocus",f)),o.dispatchEvent(l),l.defaultPrevented||(ve(pe(R(o)),{select:!0}),E()===s&&h(o))}u(()=>{o.removeEventListener(_,v=>r("mountAutoFocus",v));const l=new CustomEvent(k,B),f=v=>{r("unmountAutoFocus",v)};o.addEventListener(k,f),o.dispatchEvent(l),setTimeout(()=>{l.defaultPrevented||h(s??document.body,{select:!0}),o.removeEventListener(k,f),m.remove(d)},0)})});function b(u){if(!n.loop&&!n.trapped||d.paused)return;const o=u.key==="Tab"&&!u.altKey&&!u.ctrlKey&&!u.metaKey,s=E();if(o&&s){const p=u.currentTarget,[l,f]=me(p);l&&f?!u.shiftKey&&s===f?(u.preventDefault(),n.loop&&h(l,{select:!0})):u.shiftKey&&s===l&&(u.preventDefault(),n.loop&&h(f,{select:!0})):s===p&&u.preventDefault()}}return(u,o)=>(J(),z(ee(ne),{ref_key:"currentRef",ref:a,tabindex:"-1","as-child":u.asChild,as:u.as,onKeydown:b},{default:Q(()=>[Z(u.$slots,"default")]),_:3},8,["as-child","as"]))}}),Ce=be;export{Ce as F,ke as a,_e as u};
