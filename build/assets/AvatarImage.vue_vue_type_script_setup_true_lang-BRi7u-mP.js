import{c as A}from"./utils-B2uM22MF.js";import{d as i,r as m,y as d,b as c,w as p,m as f,u as o,j as b,z as R,q as w,o as M,l as $,t as B,i as E,bS as F,bM as I,x as j,K as q}from"./app-DbhAseKL.js";import{u as h}from"./useForwardExpose-DXHmXuPU.js";import{P as y}from"./Primitive-Cyv5IaP_.js";import{f as L}from"./index-CfbkxBOr.js";import{c as x}from"./createContext-CAhNy-JF.js";const[k,z]=x("AvatarRoot");var P=i({__name:"AvatarRoot",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(a){return h(),z({imageLoadingStatus:m("idle")}),(e,s)=>(c(),d(o(y),{"as-child":e.asChild,as:e.as},{default:p(()=>[f(e.$slots,"default")]),_:3},8,["as-child","as"]))}}),N=P,T=i({__name:"AvatarFallback",props:{delayMs:{type:Number,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"span"}},setup(a){const e=a,s=k();h();const l=m(e.delayMs===void 0);return b(r=>{if(e.delayMs&&L){const n=window.setTimeout(()=>{l.value=!0},e.delayMs);r(()=>{window.clearTimeout(n)})}}),(r,n)=>l.value&&o(s).imageLoadingStatus.value!=="loaded"?(c(),d(o(y),{key:0,"as-child":r.asChild,as:r.as},{default:p(()=>[f(r.$slots,"default")]),_:3},8,["as-child","as"])):R("v-if",!0)}}),D=T;function S(a,e){return a?e?(a.src!==e&&(a.src=e),a.complete&&a.naturalWidth>0?"loaded":"loading"):"error":"idle"}function K(a,{referrerPolicy:e,crossOrigin:s}={}){const l=m(!1),r=m(null),n=w(()=>l.value?(!r.value&&L&&(r.value=new window.Image),r.value):null),v=m(S(n.value,a.value)),_=u=>()=>{l.value&&(v.value=u)};return M(()=>{l.value=!0,b(u=>{const t=n.value;if(!t)return;v.value=S(t,a.value);const g=_("loaded"),C=_("error");t.addEventListener("load",g),t.addEventListener("error",C),e!=null&&e.value&&(t.referrerPolicy=e.value),typeof(s==null?void 0:s.value)=="string"&&(t.crossOrigin=s.value),u(()=>{t.removeEventListener("load",g),t.removeEventListener("error",C)})})}),$(()=>{l.value=!1}),v}var O=i({__name:"AvatarImage",props:{src:{type:String,required:!0},referrerPolicy:{type:null,required:!1},crossOrigin:{type:null,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"img"}},emits:["loadingStatusChange"],setup(a,{emit:e}){const s=a,l=e,{src:r,referrerPolicy:n,crossOrigin:v}=B(s);h();const _=k(),u=K(r,{referrerPolicy:n,crossOrigin:v});return E(u,t=>{l("loadingStatusChange",t),t!=="idle"&&(_.imageLoadingStatus.value=t)},{immediate:!0}),(t,g)=>F((c(),d(o(y),{role:"img","as-child":t.asChild,as:t.as,src:o(r),"referrer-policy":o(n)},{default:p(()=>[f(t.$slots,"default")]),_:3},8,["as-child","as","src","referrer-policy"])),[[I,o(u)==="loaded"]])}}),U=O;const Y=i({__name:"Avatar",props:{class:{}},setup(a){const e=a;return(s,l)=>(c(),d(o(N),{"data-slot":"avatar",class:j(o(A)("relative flex size-8 shrink-0 overflow-hidden rounded-full",e.class))},{default:p(()=>[f(s.$slots,"default")]),_:3},8,["class"]))}}),Z=i({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{type:[String,Object,Function]},class:{}},setup(a){const e=a,s=w(()=>{const{class:l,...r}=e;return r});return(l,r)=>(c(),d(o(D),q({"data-slot":"avatar-fallback"},s.value,{class:o(A)("bg-muted flex size-full items-center justify-center rounded-full",e.class)}),{default:p(()=>[f(l.$slots,"default")]),_:3},16,["class"]))}}),V=i({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{type:[String,Object,Function]}},setup(a){const e=a;return(s,l)=>(c(),d(o(U),q({"data-slot":"avatar-image"},e,{class:"aspect-square size-full"}),{default:p(()=>[f(s.$slots,"default")]),_:3},16))}});export{V as _,Z as a,Y as b};
